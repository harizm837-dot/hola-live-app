<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hola Live</title>
<link rel="stylesheet" href="assets/css/live.css">
<style>
body {
    margin:0;
    background:black;
    color:white;
    font-family:Arial;
}
.video-area {
    height:100vh;
    background: linear-gradient(180deg,#111,#000);
    position:relative;
}
.role-panel {
    position:fixed;
    top:10px;
    right:10px;
    background:#111;
    padding:10px;
    border-radius:10px;
    font-size:12px;
}
.streamer-controls {
    position:fixed;
    bottom:80px;
    right:10px;
    background:#222;
    padding:10px;
    border-radius:10px;
    display:none;
}
</style>
</head>
<body>

<div class="video-area">

    <div class="live-top-bar">
        <div class="live-badge">LIVE</div>
        <div>ğŸ‘ <span id="viewerCount">0</span></div>
        <div>â± <span id="liveTimer">00:00</span></div>
        <div>ğŸ’ <span id="earnings">0</span></div>
    </div>

    <div id="giftContainer"></div>

</div>

<!-- Bottom Control -->
<div class="live-bottom-bar">
    <div class="live-btn" onclick="sendChat()">ğŸ’¬</div>
    <div class="live-btn" onclick="sendGift()">ğŸ</div>
    <div class="live-btn" onclick="sendReaction()">â¤ï¸</div>
    <div class="live-btn">â­</div>
    <div class="live-btn">ğŸ”—</div>
</div>

<!-- Streamer Controls -->
<div class="streamer-controls" id="streamerPanel">
    <button onclick="stopLive()">â›” Stop Live</button>
</div>

<!-- Dev Role Switch Panel -->
<div class="role-panel">
    Role: <span id="currentRole"></span><br><br>
    <button onclick="RoleEngine.setRole('viewer')">Viewer</button>
    <button onclick="RoleEngine.setRole('streamer')">Streamer</button>
    <button onclick="RoleEngine.setRole('moderator')">Mod</button>
</div>

<script src="assets/js/eventBus.js"></script>
<script src="assets/js/roleEngine.js"></script>
<script src="assets/js/guard.js"></script>
<script src="assets/js/liveEngine.js"></script>

<script>

// Permission Guard
requireRole([
    RoleEngine.ROLES.VIEWER,
    RoleEngine.ROLES.STREAMER,
    RoleEngine.ROLES.MODERATOR
]);

// Show Current Role
document.getElementById("currentRole").innerText = RoleEngine.getRole();

// Streamer UI
if(RoleEngine.is(RoleEngine.ROLES.STREAMER)){
    document.getElementById("streamerPanel").style.display = "block";
}

// Stop Live (Streamer only)
function stopLive(){
    if(!RoleEngine.is(RoleEngine.ROLES.STREAMER)){
        alert("Only Streamer can stop live");
        return;
    }
    alert("Live Ended ğŸ”´");
    window.location.href = "index.html";
}

// Chat Simulation
function sendChat(){
    alert("Chat sent ğŸ’¬");
}

// Gift
function sendGift(){
    LiveEvent.emit("gift_received", 10);
}

// Reaction
function sendReaction(){
    const heart = document.createElement("div");
    heart.className = "gift-float";
    heart.innerText = "â¤ï¸";
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(),2000);
}

// Gift Listener
LiveEvent.on("gift_received",(value)=>{
    const gift = document.createElement("div");
    gift.className = "gift-float";
    gift.innerText = "ğŸ +" + value;
    document.body.appendChild(gift);
    setTimeout(()=>gift.remove(),2000);
});

</script>

</body>
</html>
