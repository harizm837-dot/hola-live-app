<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hola Live - Stream</title>

<link rel="stylesheet" href="../assets/css/reset.css">
<link rel="stylesheet" href="../assets/css/variables.css">
<link rel="stylesheet" href="../assets/css/layout.css">
<link rel="stylesheet" href="../assets/css/components.css">
<link rel="stylesheet" href="../assets/css/animations.css">
<link rel="stylesheet" href="../assets/css/responsive.css">

<style>
body{
    margin:0;
    background:#000;
    color:white;
    font-family:Arial, sans-serif;
    overflow:hidden;
    transition:opacity 0.3s ease;
}

/* STREAM VIDEO & BACKGROUND */
.video-area{
    height:100vh;
    position:relative;
    background:linear-gradient(180deg,#111,#000);
}

#liveCanvas{
    position:absolute;
    inset:0;
    z-index:0;
}

/* TOP BAR */
.live-top-bar{
    position:fixed;
    top:10px;
    left:50%;
    transform:translateX(-50%);
    display:flex;
    gap:1.2rem;
    font-size:14px;
    z-index:1000;
    background:rgba(0,0,0,.35);
    padding:6px 12px;
    border-radius:8px;
}

/* WALLET / VIP */
.wallet-box{
    position:absolute;
    top:10px;
    right:140px;
    font-size:14px;
    z-index:1000;
}
.vip-badge{
    position:absolute;
    top:50px;
    right:140px;
    font-size:14px;
    color:gold;
}

/* STREAMER PANEL */
.streamer-controls{
    position:fixed;
    bottom:90px;
    right:10px;
    background:#222;
    padding:12px;
    border-radius:10px;
    display:none;
    z-index:1000;
}

/* ROLE PANEL */
.role-panel{
    position:fixed;
    top:10px;
    right:10px;
    background:#111;
    padding:10px;
    border-radius:10px;
    font-size:12px;
    z-index:1000;
}

/* BOTTOM CONTROLS */
.live-bottom-bar{
    position:fixed;
    bottom:10px;
    left:50%;
    transform:translateX(-50%);
    display:flex;
    gap:8px;
    z-index:1000;
}
.live-btn{
    width:44px;
    height:44px;
    border-radius:50%;
    background:rgba(0,255,255,.2);
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    font-size:20px;
    transition:all .3s ease;
}
.live-btn:hover{
    background:#00eaff;
    color:#000;
}

/* Chat Box */
.chat-box{
    position:absolute;
    bottom:70px;
    left:10px;
    width:240px;
    max-height:50vh;
    background:rgba(0,0,0,0.5);
    padding:6px;
    border-radius:8px;
    overflow-y:auto;
    font-size:13px;
    z-index:1000;
}
.chat-msg{
    margin-bottom:4px;
}
.user-msg{
    color:#00eaff;
}

/* Gift Pop Animation */
.combo-pop{
    position:absolute;
    font-size:20px;
    font-weight:bold;
    color:#00eaff;
    animation:giftFloat 2s ease-out forwards;
    z-index:1500;
}
@keyframes giftFloat{
    0%{opacity:1; transform:translateY(0);}
    100%{opacity:0; transform:translateY(-80px);}
}

/* Footer */
.live-footer{
    position:fixed;
    bottom:0;
    width:100%;
    text-align:center;
    font-size:12px;
    opacity:.6;
    z-index:1000;
}
</style>
</head>
<body>

<!-- STREAM VIDEO AREA -->
<div class="video-area">
    <canvas id="liveCanvas"></canvas>

    <!-- WALLET -->
    <div class="wallet-box">
        Wallet: üíé <span id="walletTokens">0</span>
    </div>

    <!-- VIP BADGE -->
    <div class="vip-badge" id="vipBadge"></div>

    <!-- CHAT -->
    <div class="chat-box" id="chatBox"></div>

</div>

<!-- STREAMER PANEL -->
<div class="streamer-controls" id="streamerPanel">
    <button onclick="stopLive()">‚õî Stop Live</button>
</div>

<!-- ROLE PANEL -->
<div class="role-panel">
Role: <span id="currentRole"></span><br><br>
<button onclick="RoleEngine.setRole('viewer')">Viewer</button>
<button onclick="RoleEngine.setRole('streamer')">Streamer</button>
<button onclick="RoleEngine.setRole('moderator')">Mod</button>
</div>

<!-- BOTTOM BAR -->
<div class="live-bottom-bar">
    <div class="live-btn" onclick="sendChat()">üí¨</div>
    <div class="live-btn" onclick="sendGift()">üéÅ</div>
    <div class="live-btn" onclick="sendReaction()">‚ù§Ô∏è</div>
    <div class="live-btn" onclick="window.location.href='leaderboard.html'">üèÜ</div>
    <div class="live-btn" onclick="window.location.href='store.html'">üõí</div>
    <div class="live-btn" onclick="window.location.href='analytics.html'">üìä</div>
    <div class="live-btn" onclick="VIP.activateVIP()">üëë</div>
    <div class="live-btn" onclick="openModPanel()">üõ°</div>
</div>

<!-- FOOTER -->
<footer class="live-footer">
¬© 2026 Hola Live. –ë“Ø—Ö —ç—Ä—Ö —Ö—É—É–ª–∏–∞—Ä —Ö–∞–º–≥–∞–∞–ª–∞–≥–¥—Å–∞–Ω.
</footer>

<!-- ========================= -->
<!-- SCRIPTS -->
<!-- ========================= -->
<script src="../assets/js/core/state.js"></script>
<script src="../assets/js/core/router.js"></script>
<script src="../assets/js/core/notifications.js"></script>
<script src="../assets/js/economy/token.js"></script>
<script src="../assets/js/economy/gift.js"></script>
<script src="../assets/js/features/liveEngine.js"></script>
<script src="../assets/js/uiEnhance.js"></script>

<script>
// ==== Canvas Stream Simulation ====
const canvas = document.getElementById('liveCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
for(let i=0;i<600;i++){
    particles.push({
        x: Math.random()*canvas.width,
        y: Math.random()*canvas.height,
        size: Math.random()*2+1,
        speed: Math.random()*1.5+0.2
    });
}
function animateCanvas(){
    ctx.fillStyle='rgba(0,0,0,0.2)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#00eaff';
    particles.forEach(p=>{
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
        ctx.fill();
        p.y -= p.speed;
        if(p.y<0) p.y=canvas.height;
    });
    requestAnimationFrame(animateCanvas);
}
animateCanvas();
window.addEventListener('resize',()=>{
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;
});

// ==== Viewer Count Simulation ====
const viewerCountEl = document.getElementById('viewerCount') || document.createElement('span');
let viewers = Math.floor(Math.random()*500);
if(viewerCountEl) viewerCountEl.textContent = `“Æ–∑—ç–≥—á–∏–¥: ${viewers}`;
setInterval(()=>{
    viewers += Math.floor(Math.random()*3-1);
    if(viewers<0) viewers=0;
    if(viewerCountEl) viewerCountEl.textContent = `“Æ–∑—ç–≥—á–∏–¥: ${viewers}`;
},3000);

// ==== Chat Simulation ====
const chatBox = document.getElementById('chatBox');
const fakeMsgs = ["–°–∞–π–Ω —É—É!", "–°—Ç—Ä–∏–º —Å–∞–π–Ω –±–∞–π–Ω–∞!", "–•–∞–Ω–¥–∞–ª—Ç –∏—Ö –±–∞–π–Ω–∞!", "üíñüíñ", "–ë–∞—è—Ä–ª–∞–ª–∞–∞!"];
setInterval(()=>{
    const msg = fakeMsgs[Math.floor(Math.random()*fakeMsgs.length)];
    const div = document.createElement('div');
    div.className='chat-msg';
    div.textContent = msg;
    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
},2500);

// ==== Gift Animation ====
let activeGifts = [];
function spawnGift(type){
    const gift = {
        type,
        x: Math.random()*canvas.width,
        y: canvas.height,
        size: 40 + Math.random()*20,
        speed: 2 + Math.random()*2
    };
    activeGifts.push(gift);
}
function animateGifts(){
    ctx.fillStyle='rgba(0,0,0,0)';
    activeGifts.forEach((gift,i)=>{
        ctx.font = `${gift.size}px Arial`;
        ctx.fillText(gift.type,gift.x,gift.y);
        gift.y -= gift.speed;
        if(gift.y<-50) activeGifts.splice(i,1);
    });
    requestAnimationFrame(animateGifts);
}
animateGifts();

// Gift buttons
document.querySelectorAll('.live-btn').forEach(btn=>{
    if(btn.innerText==='üéÅ') btn.addEventListener('click',()=>spawnGift('üéÅ'));
    if(btn.innerText==='‚ù§Ô∏è') btn.addEventListener('click',()=>spawnGift('‚ù§Ô∏è'));
});

// ==== Role & Streamer Panel ====
document.addEventListener('DOMContentLoaded',()=>{
    document.getElementById("currentRole").innerText = RoleEngine.getRole();
    if(RoleEngine.is(RoleEngine.ROLES.STREAMER)){
        document.getElementById("streamerPanel").style.display="block";
    }
    if(VIP.isVIP()){
        document.getElementById("vipBadge").innerText="üëë VIP ACTIVE";
    }
});

// ==== Streamer Control ====
function stopLive(){
    if(!RoleEngine.is(RoleEngine.ROLES.STREAMER)){
        alert("Only Streamer can stop live");
        return;
    }
    alert("Live Ended üî¥");
    window.location.href="../index.html";
}
</script>

</body>
</html>
