<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hola Live</title>

<link rel="stylesheet" href="assets/css/live.css">
<link rel="stylesheet" href="assets/css/realtime.css">
<link rel="stylesheet" href="assets/css/platform.css">

<style>
body{
    margin:0;
    background:#000;
    color:white;
    font-family:Arial;
    overflow:hidden;
    transition:opacity 0.3s ease;
}

.video-area{
    height:100vh;
    background:linear-gradient(180deg,#111,#000);
    position:relative;
}

.wallet-box{
    position:absolute;
    top:10px;
    right:120px;
    font-size:14px;
}

.role-panel{
    position:fixed;
    top:10px;
    right:10px;
    background:#111;
    padding:10px;
    border-radius:10px;
    font-size:12px;
    z-index:1000;
}

.streamer-controls{
    position:fixed;
    bottom:90px;
    right:10px;
    background:#222;
    padding:10px;
    border-radius:10px;
    display:none;
    z-index:1000;
}

.vip-badge{
    position:absolute;
    top:50px;
    right:120px;
    font-size:14px;
    color:gold;
}
</style>
</head>
<body>

<div class="video-area">

    <!-- TOP BAR -->
    <div class="live-top-bar">
        <div class="live-badge">LIVE</div>
        <div>ğŸ‘ <span id="viewerCount">0</span></div>
        <div>â± <span id="liveTimer">00:00</span></div>
        <div>ğŸ’ <span id="earnings">0</span></div>
    </div>

    <!-- WALLET -->
    <div class="wallet-box">
        Wallet: ğŸ’ <span id="walletTokens">0</span>
    </div>

    <!-- VIP BADGE -->
    <div class="vip-badge" id="vipBadge"></div>

</div>

<!-- BOTTOM CONTROLS -->
<div class="live-bottom-bar">
    <div class="live-btn" onclick="sendChat()">ğŸ’¬</div>
    <div class="live-btn" onclick="sendGift()">ğŸ</div>
    <div class="live-btn" onclick="sendReaction()">â¤ï¸</div>
    <div class="live-btn" onclick="window.location.href='leaderboard.html'">ğŸ†</div>
    <div class="live-btn" onclick="window.location.href='store.html'">ğŸ›’</div>
    <div class="live-btn" onclick="window.location.href='analytics.html'">ğŸ“Š</div>
    <div class="live-btn" onclick="VIP.activateVIP()">ğŸ‘‘</div>
    <div class="live-btn" onclick="openModPanel()">ğŸ›¡</div>
</div>

<!-- STREAMER PANEL -->
<div class="streamer-controls" id="streamerPanel">
    <button onclick="stopLive()">â›” Stop Live</button>
</div>

<!-- DEV ROLE PANEL -->
<div class="role-panel">
    Role: <span id="currentRole"></span><br><br>
    <button onclick="RoleEngine.setRole('viewer')">Viewer</button>
    <button onclick="RoleEngine.setRole('streamer')">Streamer</button>
    <button onclick="RoleEngine.setRole('moderator')">Mod</button>
</div>

<!-- ========================= -->
<!-- SCRIPTS -->
<!-- ========================= -->

<script src="assets/js/eventBus.js"></script>
<script src="assets/js/roleEngine.js"></script>
<script src="assets/js/guard.js"></script>
<script src="assets/js/liveEngine.js"></script>
<script src="assets/js/realtimeEngine.js"></script>
<script src="assets/js/economyEngine.js"></script>
<script src="assets/js/leaderboard.js"></script>
<script src="assets/js/growthEngine.js"></script>
<script src="assets/js/vipEngine.js"></script>
<script src="assets/js/analyticsEngine.js"></script>
<script src="assets/js/moderatorPanel.js"></script>
<script src="assets/js/uiEnhance.js"></script>

<script>

// ===============================
// ROLE GUARD
// ===============================

requireRole([
    RoleEngine.ROLES.VIEWER,
    RoleEngine.ROLES.STREAMER,
    RoleEngine.ROLES.MODERATOR
]);

// ===============================
// INIT UI
// ===============================

document.addEventListener("DOMContentLoaded",()=>{

    document.getElementById("currentRole").innerText = RoleEngine.getRole();

    if(RoleEngine.is(RoleEngine.ROLES.STREAMER)){
        document.getElementById("streamerPanel").style.display="block";
    }

    Economy.updateWalletUI();

    if(VIP.isVIP()){
        document.getElementById("vipBadge").innerText="ğŸ‘‘ VIP ACTIVE";
    }
});

// ===============================
// STREAMER CONTROL
// ===============================

function stopLive(){
    if(!RoleEngine.is(RoleEngine.ROLES.STREAMER)){
        alert("Only Streamer can stop live");
        return;
    }
    alert("Live Ended ğŸ”´");
    window.location.href="index.html";
}

// ===============================
// CHAT
// ===============================

function sendChat(){
    LiveEvent.emit("chat_message",{text:"You sent a message!"});
}

// ===============================
// GIFT SYSTEM
// ===============================

function sendGift(){

    const cost = 20;

    if(Economy.spendTokens(cost)){
        LiveEvent.emit("gift_received", cost);
        updateLeaderboard("You", cost);
        Analytics.recordGift(cost);
    }
}

// ===============================
// REACTION
// ===============================

function sendReaction(){
    const heart=document.createElement("div");
    heart.className="reaction-float";
    heart.innerText="â¤ï¸";
    heart.style.left=Math.random()*90+"%";
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(),3000);
}

// ===============================
// VISUAL GIFT POP
// ===============================

LiveEvent.on("gift_received",(value)=>{
    const el=document.createElement("div");
    el.className="combo-pop";
    el.innerText="ğŸ +"+value;
    document.body.appendChild(el);
    setTimeout(()=>el.remove(),2000);
});

</script>

</body>
</html>
